{"ast":null,"code":"var _jsxFileName = \"/home/nonseodion/Desktop/Codes/ETHLagos/ipfs-inbox/client/src/App.js\";\nimport React, { Component } from \"react\";\nimport IPFSInbox from \"./contracts/IPFSInbox.json\";\nimport getWeb3 from \"./getWeb3\";\nimport ipfs from \"./ipfs\";\nimport \"./App.css\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = async () => {\n      try {\n        // Get network provider and web3 instance.\n        const web3 = await getWeb3(); // Use web3 to get the user's accounts.\n\n        const accounts = await web3.eth.getAccounts(); // Get the contract instance.\n\n        const networkId = await web3.eth.net.getId();\n        const deployedNetwork = IPFSInbox.networks[networkId];\n        const instance = new web3.eth.Contract(IPFSInbox.abi, deployedNetwork && deployedNetwork.address); // Set web3, accounts, and contract to the state, and then proceed with an\n        // example of interacting with the contract's methods.\n\n        this.setState({\n          web3,\n          accounts,\n          contract: instance\n        });\n        this.setEventListeners();\n      } catch (error) {\n        // Catch any errors for any of the above operations.\n        alert(\"Failed to load web3, accounts, or contract. Check console for details.\");\n        console.error(error);\n      }\n    };\n\n    this.captureFile = event => {\n      event.stopPropagation();\n      event.preventDefault();\n      const file = event.target.files[0];\n      const reader = new window.FileReader();\n      reader.readAsArrayBuffer(file);\n\n      reader.onloadend = () => this.convertToBuffer(reader);\n    };\n\n    this.convertToBuffer = async reader => {\n      const buffer = await Buffer.from(reader.result);\n      this.setState({\n        buffer\n      });\n    };\n\n    this.onIPFSSubmit = async event => {\n      event.preventDefault();\n      await ipfs.add(this.state.buffer, (err, ipfsHash) => {\n        console.log(err, ipfsHash);\n        this.setState({\n          ipfsHash: ipfsHash[0].hash\n        });\n      });\n    };\n\n    this.state = {\n      storageValue: 0,\n      web3: null,\n      accounts: null,\n      contract: null,\n      ipfsHash: null\n    };\n  }\n\n  setEventListeners() {\n    this.state.contract.inboxResponse().on(\"data\", result => {\n      this.setState({\n        receivedIPFS: result.args[0]\n      });\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, \" 1. Add a file to IPFS here.\"), React.createElement(\"form\", {\n      id: \"ipfs-hash-form\",\n      className: \"scep-form\",\n      onSubmit: this.onIPFSSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"file\",\n      onChange: this.captureFile,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, \" Send it\")), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, \"The IPFS hash is: \", this.state.ipfsHash));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/nonseodion/Desktop/Codes/ETHLagos/ipfs-inbox/client/src/App.js"],"names":["React","Component","IPFSInbox","getWeb3","ipfs","App","constructor","props","componentDidMount","web3","accounts","eth","getAccounts","networkId","net","getId","deployedNetwork","networks","instance","Contract","abi","address","setState","contract","setEventListeners","error","alert","console","captureFile","event","stopPropagation","preventDefault","file","target","files","reader","window","FileReader","readAsArrayBuffer","onloadend","convertToBuffer","buffer","Buffer","from","result","onIPFSSubmit","add","state","err","ipfsHash","log","hash","storageValue","inboxResponse","on","receivedIPFS","args","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport IPFSInbox from \"./contracts/IPFSInbox.json\";\nimport getWeb3 from \"./getWeb3\";\nimport ipfs from \"./ipfs\";\n\nimport \"./App.css\";\n\nclass App extends Component {\n  \n  constructor(props){\n    super(props);\n    this.state = { storageValue: 0, web3: null, accounts: null, contract: null, ipfsHash: null };\n  }\n  \n\n  componentDidMount = async () => {\n    try {\n      // Get network provider and web3 instance.\n      const web3 = await getWeb3();\n\n      // Use web3 to get the user's accounts.\n      const accounts = await web3.eth.getAccounts();\n\n      // Get the contract instance.\n      const networkId = await web3.eth.net.getId();\n      const deployedNetwork = IPFSInbox.networks[networkId];\n      const instance = new web3.eth.Contract(\n        IPFSInbox.abi,\n        deployedNetwork && deployedNetwork.address,\n      );\n\n      // Set web3, accounts, and contract to the state, and then proceed with an\n      // example of interacting with the contract's methods.\n      this.setState({ web3, accounts, contract: instance });\n      this.setEventListeners();\n    } catch (error) {\n      // Catch any errors for any of the above operations.\n      alert(\n        `Failed to load web3, accounts, or contract. Check console for details.`,\n      );\n      console.error(error);\n    }\n  };\n\n  captureFile = (event) => {\n    event.stopPropagation();\n    event.preventDefault();\n    const file = event.target.files[0];\n    const reader = new window.FileReader();\n    reader.readAsArrayBuffer(file);\n    reader.onloadend = () => this.convertToBuffer(reader);\n  }\n\n  convertToBuffer = async (reader) => {\n    const buffer = await Buffer.from(reader.result);\n    this.setState({buffer});\n  }\n\n  onIPFSSubmit = async (event) => {\n    event.preventDefault();\n    await ipfs.add(this.state.buffer, (err, ipfsHash) => {\n      console.log(err, ipfsHash);\n      this.setState({ipfsHash: ipfsHash[0].hash});\n    })\n  }\n\n  setEventListeners(){\n    this.state.contract.inboxResponse()\n      .on(\"data\", result => {\n        this.setState({receivedIPFS: result.args[0]});\n      })\n  }\n\n  render() {\n    return(\n      <div className=\"App\">\n        <h2> 1. Add a file to IPFS here.</h2>\n        <form id=\"ipfs-hash-form\" className=\"scep-form\" onSubmit={this.onIPFSSubmit}>\n          <input\n            type=\"file\"\n            onChange={this.captureFile}\n          />\n          <button type=\"submit\" > Send it</button>\n        </form>\n        <p>The IPFS hash is: {this.state.ipfsHash}</p>\n      </div>\n    )\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}